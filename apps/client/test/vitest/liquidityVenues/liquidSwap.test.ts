import { executorAbi } from "executooor-viem";
import { Address, encodeFunctionData, erc20Abi, parseUnits } from "viem";
import { readContract, writeContract } from "viem/actions";
import { describe, expect } from "vitest";

import { LiquidSwapVenue } from "../../../src/liquidityVenues/liquidSwap";
import { liquidSwapTest } from "../../setup";

const WHYPE = "0x5555555555555555555555555555555555555555" as Address;
const USDC = "0xb88339CB7199b77E23DB6E890353E22632Ba630f" as Address;

const liquidityVenue = new LiquidSwapVenue();

describe("LiquidSwap liquidity venue", () => {
  liquidSwapTest.sequential(`should test supportsRoute`, async ({ encoder }) => {
    expect(liquidityVenue.supportsRoute(encoder, WHYPE, WHYPE)).toBe(false);
    expect(liquidityVenue.supportsRoute(encoder, WHYPE, USDC)).toBe(true);
    expect(liquidityVenue.supportsRoute(encoder, USDC, WHYPE)).toBe(true);
  });

  liquidSwapTest.only(`should test convert encoding`, async ({ encoder }) => {
    await liquidityVenue.convert(encoder, {
      src: WHYPE,
      dst: USDC,
      srcAmount: parseUnits("1000", 18),
    });
  });
});

const response = {
  success: true,
  tokens: {
    tokenIn: {
      address: "0x5555555555555555555555555555555555555555",
      symbol: "WHYPE",
      name: "Wrapped HYPE",
      decimals: 18,
    },
    tokenOut: {
      address: "0xb88339cb7199b77e23db6e890353e22632ba630f",
      symbol: "USDC",
      name: "USDC",
      decimals: 6,
    },
    intermediates: [],
  },
  amountIn: "1000",
  amountOut: "22542.270506",
  averagePriceImpact: "36.655424%",
  execution: {
    to: "0x744489ee3d540777a66f2cf297479745e0852f7a",
    calldata:
      "0xa22c27fe00000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000003635c9adc5dea0000000000000000000000000000000000000000000000000000000000005323012b8000000000000000000000000000000000000000000000000000000053f9fc02a00000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000005555555555555555555555555555555555555555000000000000000000000000b88339cb7199b77e23db6e890353e22632ba630f0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000040000000000000000000000005555555555555555555555555555555555555555000000000000000000000000b88339cb7199b77e23db6e890353e22632ba630f00000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000bb800000000000000000000000000000000000000000000002c68af0bb14000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005555555555555555555555555555555555555555000000000000000000000000b88339cb7199b77e23db6e890353e22632ba630f00000000000000000000000000000000000000000000000000000000000000130000000000000000000000000000000000000000000000000000000000000bb80000000000000000000000000000000000000000000000053444835ec580000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005555555555555555555555555555555555555555000000000000000000000000b88339cb7199b77e23db6e890353e22632ba630f000000000000000000000000000000000000000000000000000000000000001300000000000000000000000000000000000000000000000000000000000001f4000000000000000000000000000000000000000000000003bc2df8f3c06a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005555555555555555555555555555555555555555000000000000000000000000b88339cb7199b77e23db6e890353e22632ba630f000000000000000000000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dca825c218b600000000000000000000000000000000000000000000000000000000000000000000",
    details: {
      path: [Array],
      amountIn: "1000000000000000000000",
      amountOut: "22542270506",
      minAmountOut: "22316847800",
      hopSwaps: [Array],
    },
  },
};
